trigger:
- master

variables:
  # Container registry service connection established during pipeline creation
  dockerRegistryServiceConnection: 'f633da39-b402-4c04-9d26-575faa61735f'
  # imageRepository: 'Nodejs'
  # containerRegistry: 'nodeapp2.azurecr.io'
  # dockerfilePath: '$(Build.SourcesDirectory)/Dockerfile'
  tag: '$(Build.BuildId)'
  
  vmImageName: 'ubuntu-latest'

stages:
  - stage: build 
    
    jobs:  
    - job: Build
      displayName: Build
      pool:
        vmImage: $(vmImageName)
      steps:
      - task: Docker@2
        displayName: Build and push an image to container registry
        inputs:
         command: buildAndPush
         repository: 'Nodejs'
         dockerfile: $(Build.SourcesDirectory)/Dockerfile'
         containerRegistry: nodeapp2.azurecr.io
         tags: |
          $(tag)  


